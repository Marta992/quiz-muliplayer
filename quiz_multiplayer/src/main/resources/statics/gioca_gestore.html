<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gioco - Quiz Multiplayer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .selected-answer {
            background-color: #007bff !important;
            color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="#">Quiz Multiplayer - Gioca</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link active" href="#">Gioca</a></li>
                <li class="nav-item"><a class="nav-link" href="punteggi_gestore.html">Punteggi</a></li>
                <li class="nav-item"><a class="nav-link" href="creatore.html">Gestisci</a></li>
                <li class="nav-item"><a class="nav-link" href="accedi.html">Esci</a></li>
            </ul>
        </div>
    </nav>
    <div class="container vh-100 d-flex justify-content-center align-items-center">
        <div id="gameContainer" class="w-75 p-4 text-center">
            <!-- Pulsante per iniziare il gioco -->
            <button id="startGameBtn" class="btn btn-primary btn-lg">Inizia Gioco</button>

            <!-- Elementi del gioco nascosti finché il gioco non inizia -->
            <h2 id="questionText" style="display: none;">Caricamento domanda...</h2>
            <div id="timer" class="mt-2" style="display: none;">Tempo rimasto: <span id="timeLeft">10</span> secondi</div>
            <div id="answerOptions" class="mt-4"></div>
            <button id="nextQuestionBtn" class="btn btn-primary btn-lg mt-4" disabled style="display: none;">Prossima Domanda</button>
            <div id="score" class="mt-4" style="display: none;">Punteggio: <span id="scoreValue">0</span></div>
            <button id="playAgainBtn" class="btn btn-success btn-lg mt-4 mx-auto" style="display: none;">Gioca di nuovo</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "Qual è la capitale d'Italia?",
                choices: ["Roma", "Milano", "Napoli", "Torino"],
                correctAnswer: 0
            },
            {
                question: "Quale pianeta è conosciuto come il Pianeta Rosso?",
                choices: ["Marte", "Venere", "Giove", "Saturno"],
                correctAnswer: 0
            },
            // Aggiungi altre domande o caricale da un backend in futuro
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let timeLeft = 10;
        let timerInterval;
        let hasAnswered = false;

        // Funzione per caricare una domanda
        function loadQuestion() {
            clearInterval(timerInterval);  // Stoppa il timer precedente
            timeLeft = 10;                 // Reset del timer
            document.getElementById("timeLeft").textContent = timeLeft;
            document.getElementById("nextQuestionBtn").disabled = true; // Disabilita il pulsante "Prossima Domanda"
            hasAnswered = false;

            const questionData = questions[currentQuestionIndex];
            document.getElementById("questionText").textContent = questionData.question;

            const answerOptions = document.getElementById("answerOptions");
            answerOptions.innerHTML = ""; // Pulisce le opzioni precedenti
            questionData.choices.forEach((choice, index) => {
                const button = document.createElement("button");
                button.className = "btn btn-outline-light btn-block my-2";
                button.textContent = choice;
                button.onclick = () => checkAnswer(button, index);
                answerOptions.appendChild(button);
            });

            // Avvia il timer
            timerInterval = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    document.getElementById("timeLeft").textContent = timeLeft;
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval); // Ferma il timer
                    if (!hasAnswered) {
                        goToNextQuestion();
                    }
                }
            }, 1000);
        }

        // Funzione per controllare la risposta
        function checkAnswer(button, selectedIndex) {
            if (hasAnswered) return; // Previene risposte multiple per la stessa domanda

            hasAnswered = true;
            document.getElementById("nextQuestionBtn").disabled = false; // Abilita il pulsante "Prossima Domanda"

            // Evidenzia la risposta selezionata
            const answerOptions = document.getElementById("answerOptions").children;
            for (const option of answerOptions) {
                option.classList.remove("selected-answer"); // Rimuove l'evidenziazione dalle altre opzioni
            }
            button.classList.add("selected-answer"); // Evidenzia l'opzione selezionata

            const questionData = questions[currentQuestionIndex];
            if (selectedIndex === questionData.correctAnswer && timeLeft > 0) {
                score++;
            }
            document.getElementById("scoreValue").textContent = score;
        }

        // Funzione per passare alla prossima domanda
        function goToNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                endQuiz(); // Se siamo all'ultima domanda, termina il quiz
            }
        }

        // Funzione per concludere il quiz
        function endQuiz() {
            document.getElementById("questionText").textContent = "Quiz terminato!";
            document.getElementById("answerOptions").innerHTML = "";
            document.getElementById("timer").style.display = "none";
            document.getElementById("nextQuestionBtn").style.display = "none";
            document.getElementById("score").innerHTML = `Punteggio finale: <span id="scoreValue">${score}</span>`;
            document.getElementById("playAgainBtn").style.display = "block";
        }

        // Funzione per avviare il gioco al click su "Inizia Gioco"
        function startGame() {
            document.getElementById("startGameBtn").style.display = "none";
            document.getElementById("questionText").style.display = "block";
            document.getElementById("timer").style.display = "block";
            document.getElementById("nextQuestionBtn").style.display = "block";
            document.getElementById("score").style.display = "block";
            loadQuestion();
        }

        // Funzione per ripristinare il gioco
        function resetGame() {
            currentQuestionIndex = 0;
            score = 0;
            timeLeft = 10;
            document.getElementById("playAgainBtn").style.display = "none";
            document.getElementById("timer").style.display = "block";
            document.getElementById("nextQuestionBtn").style.display = "block";
            document.getElementById("scoreValue").textContent = score;
            loadQuestion();
        }

        // Assegna eventi ai pulsanti
        document.getElementById("startGameBtn").addEventListener("click", startGame);
        document.getElementById("nextQuestionBtn").addEventListener("click", goToNextQuestion);
        document.getElementById("playAgainBtn").addEventListener("click", resetGame);
    </script>
</body>
</html>
